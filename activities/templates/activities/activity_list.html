{% extends "base.html" %}
{% load static %}

{% block title %}Activités - AirLibre{% endblock %}

{% block hero %}
<section class="hero-section" role="banner" aria-label="En-tête de la page">
    <div class="container">
        <div class="hero-content text-center">
            <h1 class="hero-title">
                <i class="fas fa-hiking me-3" aria-hidden="true"></i>
                Nos Activités à venir
            </h1>
            <p class="hero-subtitle">
                Découvrez notre sélection d'aventures en nature
            </p>
        </div>
    </div>
</section>
{% endblock %}

{% block content %}
<main id="main-content" tabindex="-1">
    <section class="container page-activity-list" aria-labelledby="explorer-activites">



        <!-- Filtres et contrôles -->
        <div class="filters-card fade-in-up" aria-labelledby="explorer-activites">
            <h2 id="explorer-activites" class="text-center mb-4">
                <i class="fas fa-calendar-alt me-2 text-success" aria-hidden="true"></i>
                Explorer les Activités
            </h2>

            <!-- Filtre par catégorie -->
            <div class="row justify-content-center">
                <div class="col-12 col-lg-8 mb-4">
                    <form class="category-filter-form" role="search" aria-label="Filtrer les activités">
                        <div class="row mb-4">
                            <div class="col-12 col-md-6 mx-auto">
                                <div
                                    class="d-flex flex-column flex-sm-row align-items-sm-center justify-content-sm-center gap-3">
                                    <label for="{{ form.category.id_for_label }}"
                                        class="form-label fw-semibold mb-0 text-nowrap">
                                        <i class="fas fa-filter me-2 text-success" aria-hidden="true"></i>
                                        {{ form.category.label }}:
                                    </label>
                                    <div class="flex-grow-1 flex-sm-grow-0">
                                        {{ form.category }}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row justify-content-center">
                            <div class="col-12">
                                <div
                                    class="d-flex flex-column flex-sm-row gap-2 justify-content-center align-items-stretch align-items-sm-center">
                                    <button type="submit" name="scoop" value="all"
                                        class="btn btn-details {% if scoop == 'all' %}active{% endif %} flex-sm-fill flex-lg-grow-0"
                                        aria-pressed="{% if scoop == 'all' %}true{% else %}false{% endif %}">
                                        <i class="fas fa-list-ul me-1" aria-hidden="true"></i>
                                        <span class="d-none d-sm-inline">Toutes les activités</span>
                                        <span class="d-sm-none">Toutes</span>
                                    </button>

                                    {% if user.is_authenticated %}
                                    <button type="submit" name="scoop" value="mine"
                                        class="btn btn-details {% if scoop == 'mine' %}active{% endif %} flex-sm-fill flex-lg-grow-0"
                                        aria-pressed="{% if scoop == 'mine' %}true{% else %}false{% endif %}">
                                        <i class="fas fa-user-cog me-1" aria-hidden="true"></i>
                                        <span class="d-none d-sm-inline">Mes activités</span>
                                        <span class="d-sm-none">Mes activités</span>
                                    </button>

                                    <button type="submit" name="scoop" value="inscrit"
                                        class="btn btn-details {% if scoop == 'inscrit' %}active{% endif %} flex-sm-fill flex-lg-grow-0"
                                        aria-pressed="{% if scoop == 'inscrit' %}true{% else %}false{% endif %}">
                                        <i class="fas fa-user-check me-1" aria-hidden="true"></i>
                                        <span class="d-none d-sm-inline">Mes inscriptions</span>
                                        <span class="d-sm-none">Inscrit</span>
                                    </button>
                                    {% endif %}
                                </div>

                                {% if not user.is_authenticated %}
                                <div class="text-center mt-3">
                                    <small class="text-muted">
                                        <i class="fas fa-info-circle me-1" aria-hidden="true"></i>
                                        <a href="{% url 'login' %}"
                                            class="text-success text-decoration-none">Connectez-vous</a>
                                        pour voir vos activités personnalisées
                                    </small>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Liste des activités -->
        <div class="row" aria-live="polite">
            {% if activities %}
            {% for activity in activities %}
            <div class="col-lg-4 col-md-6">
                <article class="activity-card fade-in-up" aria-labelledby="activity-title-{{ activity.id }}">
                    <header class="card-header">
                        <h3 class="activity-title" id="activity-title-{{ activity.id }}">
                            <i class="fas fa-mountain me-2" aria-hidden="true"></i>
                            {{ activity.title }}
                        </h3>
                        <div class="activity-meta">
                            <span class="badge badge-primary" aria-label="Catégorie">{{ activity.category }}</span>
                        </div>
                    </header>
                    <div class="card-body">

                        <div class="info-item">
                            <div class="info-icon">
                                <i class="fas fa-map-marker-alt" aria-hidden="true"></i>
                            </div>
                            <div>
                                <strong>Lieu:</strong> <span aria-label="Ville">{{ activity.location_city }}</span>
                            </div>
                        </div>

                        <div class="info-item">
                            <div class="info-icon">
                                <i class="fas fa-tag" aria-hidden="true"></i>
                            </div>
                            <div>
                                <strong>Date:</strong>
                                <time datetime="{{ activity.start_time|date:'c' }}">
                                    {{ activity.start_time|date:"l j F Y" }}
                                </time>
                                <span class="text-muted">
                                    à {{ activity.start_time|date:"H:i" }}
                                </span>
                            </div>
                        </div>

                        <div class="info-item">
                            <div class="info-icon">
                                <i class="fas fa-clock" aria-hidden="true"></i>
                            </div>
                            <div>
                                <strong>Propriétaire:</strong> <span aria-label="Organisateur">
                                    {{ activity.proposer.username }}</span>
                            </div>
                        </div>

                        <div class="text-center mt-3">
                            <a href="{% url 'activity_detail' activity.id %}" class="btn btn-details"
                                aria-label="Voir les détails de {{ activity.title }}">
                                <i class="fas fa-eye me-2" aria-hidden="true"></i>
                                Voir les détails
                            </a>
                        </div>
                    </div>
                </article>
            </div>
            {% endfor %}
            {% else %}
            <div class="col-12 text-center mt-4">
                <div class="alert" role="status">
                    <i class="fas fa-info-circle fa-2x mb-3" aria-hidden="true"></i>
                    <h4>Aucune activité disponible</h4>
                    <p>Revenez bientôt pour découvrir nos nouvelles aventures en plein air.</p>
                </div>
            </div>
            {% endif %}
        </div>
    </section>
</main>
{% endblock %}